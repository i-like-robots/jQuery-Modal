/*!
 * @name        jQuery Modal
 * @author      Matt Hinchliffe <https://github.com/i-like-robots/jQuery-Modal>
 * @modified    2012-12-10
 * @version     1.0.1
 */
(function(e,t){"use strict";function n(n,r){return this.opts=e.extend({},{onopen:t,onhide:t,onupdate:t,fixed:!1,overlay:!0,blur:!0,escape:!0,width:640,maxWidth:"95%",height:480,maxHeight:"95%",namespace:"modal"},r),this.target=n,this.isOpen=!1,this.isInitialized=!1,this}n.prototype._init=function(){this.doc=e(document),this.wrapper=e('<div class="modal-wrapper">').css({position:this.opts.fixed?"fixed":"absolute",width:this.opts.width,maxWidth:this.opts.maxWidth,height:this.opts.height,maxHeight:this.opts.maxHeight,display:"none"}),this.close=e('<span class="modal-close" data-'+this.opts.namespace+"-close>Close</span>").appendTo(this.wrapper),this.content=e('<div class="modal-content">').appendTo(this.wrapper),this.wrapper.appendTo(this.target),this.overlay=!1,this.opts.overlay&&(this.overlay=e('<div class="modal-overlay"'+(this.opts.blur?"data-"+this.opts.namespace+"-close":"")+">").css({position:"absolute",top:0,left:0,width:"100%",display:"none"}).appendTo(this.target)),this.isBody=this.target===document.body,this.context=this.isBody?e(window):e(this.target).css("position","relative"),this.isInitialized=!0},n.prototype.align=function(){var e=this.wrapper.outerHeight(),t=this.wrapper.outerWidth(),n=this.context.outerHeight(),r=this.context.outerWidth(),i=this.opts.fixed?0:this.context.scrollTop();this.wrapper.css({top:e<n?(n-e)/2+i:i,left:t<r?(r-t)/2:0}),this.opts.overlay&&this.overlay.css("height",this.isBody?this.doc.height():n)},n.prototype.open=function(e,t){this.isInitialized||this._init();var n=this;this.isBody&&(this.context.on("resize."+this.opts.namespace,function(){n.align()}),this.doc.on("keyup."+this.opts.namespace,function(e){e.keyCode===27&&n.hide()})),this.doc.on("click.modal","[data-"+this.opts.namespace+"-close]",function(e){e.preventDefault(),n.hide()}),this.wrapper.add(this.overlay).stop().fadeIn(),this.isOpen=!0,e&&this.update(e),this.opts.onopen&&this.opts.onopen.call(this),t&&t.call(this)},n.prototype.update=function(e,t){this.content.html(e),this.isOpen&&this.align(),this.opts.onupdate&&this.opts.onupdate.call(this),t&&t.call(this)},n.prototype.resize=function(e,t){this.wrapper.css({width:e,height:t}),this.align()},n.prototype.hide=function(e){this.doc.off("."+this.opts.namespace),this.wrapper.add(this.overlay).stop().fadeOut(),this.isOpen=!1,this.opts.onhide&&this.opts.onhide.call(this),e&&e.call(this)},e.fn.modal=function(t){return this.each(function(){e.data(this,"modal")||e.data(this,"modal",new n(this,t))})}})(jQuery);